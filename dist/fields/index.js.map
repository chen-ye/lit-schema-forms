{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/fields/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, type TemplateResult } from 'lit';\r\nimport type { JSONSchema, KeyChangeHandler, UISchema, WidgetRegistry } from '../types.js';\r\nimport { mergeSchemas } from '../utils/schema-utils.js';\r\nimport { renderArrayField, arrayFieldStyles } from './ArrayField.js';\r\nimport { renderBooleanField } from './BooleanField.js';\r\nimport { renderCompositionField, compositionFieldStyles } from './CompositionField.js';\r\nimport { renderFileField, fileFieldStyles } from './FileField.js';\r\nimport { renderNullField, nullFieldStyles } from './NullField.js';\r\nimport { renderNumberField } from './NumberField.js';\r\nimport { renderObjectField, objectFieldStyles } from './ObjectField.js';\r\nimport { renderSelectField } from './SelectField.js';\r\nimport { renderStringField } from './StringField.js';\r\nimport '@awesome.me/webawesome/dist/components/textarea/textarea.js';\r\n\r\nexport {\r\n  arrayFieldStyles,\r\n  compositionFieldStyles,\r\n  fileFieldStyles,\r\n  nullFieldStyles,\r\n  objectFieldStyles,\r\n};\r\n\r\nimport type { ValidationError } from '../utils/validator.js';\r\n\r\nexport function renderField(\r\n  key: string,\r\n  schema: JSONSchema,\r\n  value: unknown,\r\n  onChange: KeyChangeHandler,\r\n  view: UISchema = {},\r\n  path: string = '',\r\n  errors: ValidationError[] = [],\r\n  widgets: WidgetRegistry = {},\r\n): TemplateResult {\r\n  const fieldView = key === '' ? view : (view[key] as UISchema) || {};\r\n  const currentPath = path ? `${path}/${key}` : key ? `/${key}` : '';\r\n\r\n  // Check for custom widget in registry\r\n  const widgetName = fieldView['ui:widget'];\r\n  if (widgetName && typeof widgetName === 'string' && widgets[widgetName]) {\r\n    return widgets[widgetName](key, schema, value, onChange, fieldView, currentPath, errors, widgets);\r\n  }\r\n\r\n  if (fieldView['ui:widget'] === 'hidden') {\r\n    return html``;\r\n  }\r\n  if (fieldView['ui:widget'] === 'file') {\r\n    return renderFileField(key, schema, value, (val) => onChange(key, val), fieldView, currentPath, errors);\r\n  }\r\n\r\n  // Handle allOf (merge and render)\r\n  if (schema.allOf) {\r\n    const merged = mergeSchemas(schema.allOf as JSONSchema[]);\r\n    return renderField(key, merged, value, onChange, view, path, errors, widgets);\r\n  }\r\n\r\n  // Handle Composition (oneOf / anyOf)\r\n  if (schema.oneOf || schema.anyOf) {\r\n    return renderCompositionField(key, schema, value, (val) => onChange(key, val), fieldView, currentPath, errors, widgets);\r\n  }\r\n\r\n  // Handle Enum -> Select\r\n  if (schema.enum) {\r\n    return renderSelectField(key, schema, value, (val) => onChange(key, val), fieldView, currentPath, errors);\r\n  }\r\n\r\n  // Handle specific types\r\n  // Infer object if properties exist but type is missing\r\n  if (schema.type === 'object' || schema.properties) {\r\n    return renderObjectField(key, schema, value, (val) => onChange(key, val), fieldView, currentPath, errors, widgets);\r\n  }\r\n\r\n  switch (schema.type) {\r\n    case 'array':\r\n      return renderArrayField(key, schema, value, (val) => onChange(key, val), fieldView, currentPath, errors, widgets);\r\n\r\n    case 'string':\r\n      return renderStringField(key, schema, value, (val) => onChange(key, val), fieldView, currentPath, errors);\r\n\r\n    case 'number':\r\n    case 'integer':\r\n      return renderNumberField(key, schema, value, (val) => onChange(key, val), fieldView, currentPath, errors);\r\n\r\n    case 'boolean':\r\n      return renderBooleanField(key, schema, value, (val) => onChange(key, val), fieldView, currentPath, errors);\r\n\r\n    case 'null':\r\n      return renderNullField(schema);\r\n\r\n    default: {\r\n      // Default fallback (textarea-ish)\r\n      const fieldErrors = errors.filter((e) => e.instanceLocation === '#' + currentPath);\r\n      const errorMessage = fieldErrors.length > 0 ? fieldErrors.map((e) => e.error).join('; ') : undefined;\r\n\r\n      return html`\r\n        <wa-textarea\r\n          label=${schema.title || key}\r\n          value=${String(value || '')}\r\n          help-text=${errorMessage || (fieldView['ui:help'] as string) || ''}\r\n          ?invalid=${!!errorMessage}\r\n          @wa-input=${(e: Event) => onChange(key, (e.target as HTMLInputElement).value)}\r\n        ></wa-textarea>\r\n      `;\r\n    }\r\n  }\r\n}\r\n"]}