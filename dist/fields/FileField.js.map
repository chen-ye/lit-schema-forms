{"version":3,"file":"FileField.js","sourceRoot":"","sources":["../../src/fields/FileField.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,GAAG,EAAE,IAAI,EAAuB,MAAM,KAAK,CAAC;AACrD,OAAO,uDAAuD,CAAC;AAI/D,MAAM,CAAC,MAAM,eAAe,GAAG,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;CAwBjC,CAAC;AAEF,MAAM,UAAU,eAAe,CAC7B,GAAW,EACX,MAAkB,EAClB,KAAc,EACd,QAAuB,EACvB,OAAiB,EAAE,EACnB,OAAe,EAAE,EACjB,SAA4B,EAAE;IAE9B,MAAM,aAAa,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,gBAAgB,KAAK,IAAI,IAAI,EAAE,CAAC,CAAC;IAC9E,MAAM,YAAY,GAAG,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;IAEzG,MAAM,gBAAgB,GAAG,CAAC,CAAQ,EAAE,EAAE;QACpC,MAAM,KAAK,GAAG,CAAC,CAAC,MAA0B,CAAC;QAC3C,MAAM,IAAI,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;QAC9B,IAAI,CAAC,IAAI,EAAE,CAAC;YACV,QAAQ,CAAC,SAAS,CAAC,CAAC;YACpB,OAAO;QACT,CAAC;QAED,MAAM,MAAM,GAAG,IAAI,UAAU,EAAE,CAAC;QAChC,MAAM,CAAC,MAAM,GAAG,CAAC,KAAK,EAAE,EAAE;YACxB,QAAQ,CAAC,KAAK,CAAC,MAAM,EAAE,MAAgB,CAAC,CAAC;QAC3C,CAAC,CAAC;QACF,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC,CAAC;IAEF,OAAO,IAAI,CAAA;;kCAEqB,MAAM,CAAC,KAAK,IAAI,GAAG;;;kBAGnC,gBAAgB;iBACf,IAAI,CAAC,YAAY,CAA6B,EAAE,MAAiB,IAAI,EAAE;;;QAGlF,KAAK,CAAC,CAAC,CAAC,IAAI,CAAA,sCAAuC,KAAgB,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE;QACpG,YAAY,CAAC,CAAC,CAAC,IAAI,CAAA,2BAA2B,YAAY,QAAQ,CAAC,CAAC,CAAC,EAAE;;GAE5E,CAAC;AACJ,CAAC","sourcesContent":["import { css, html, type TemplateResult } from 'lit';\r\nimport '@awesome.me/webawesome/dist/components/input/input.js';\r\nimport type { ChangeHandler, JSONSchema, UISchema } from '../types.js';\r\nimport type { ValidationError } from '../utils/validator.js';\r\n\r\nexport const fileFieldStyles = css`\r\n  .file-field {\r\n    margin-bottom: 1rem;\r\n  }\r\n  .file-label {\r\n    display: block;\r\n    margin-bottom: 0.25rem;\r\n    font-weight: 500;\r\n  }\r\n  .file-input {\r\n    display: block;\r\n    width: 100%;\r\n  }\r\n  .file-current {\r\n    font-size: 0.8rem;\r\n    margin-top: 0.25rem;\r\n    word-break: break-all;\r\n    color: var(--wa-color-text-quiet);\r\n  }\r\n  .file-error {\r\n    color: var(--wa-color-danger-on-quiet);\r\n    font-size: 0.8rem;\r\n    margin-top: 0.25rem;\r\n  }\r\n`;\r\n\r\nexport function renderFileField(\r\n  key: string,\r\n  schema: JSONSchema,\r\n  value: unknown,\r\n  onChange: ChangeHandler,\r\n  view: UISchema = {},\r\n  path: string = '',\r\n  errors: ValidationError[] = [],\r\n) {\r\n  const currentErrors = errors.filter((e) => e.instanceLocation === `#${path}`);\r\n  const errorMessage = currentErrors.length > 0 ? currentErrors.map((e) => e.error).join('; ') : undefined;\r\n\r\n  const handleFileChange = (e: Event) => {\r\n    const input = e.target as HTMLInputElement;\r\n    const file = input.files?.[0];\r\n    if (!file) {\r\n      onChange(undefined);\r\n      return;\r\n    }\r\n\r\n    const reader = new FileReader();\r\n    reader.onload = (event) => {\r\n      onChange(event.target?.result as string);\r\n    };\r\n    reader.readAsDataURL(file);\r\n  };\r\n\r\n  return html`\r\n    <div class=\"file-field\">\r\n      <label class=\"file-label\">${schema.title || key}</label>\r\n      <input\r\n        type=\"file\"\r\n        @change=${handleFileChange}\r\n        accept=${((view['ui:options'] as Record<string, unknown>)?.accept as string) || ''}\r\n        class=\"file-input\"\r\n      />\r\n      ${value ? html`<div class=\"file-current\">Current: ${(value as string).substring(0, 30)}...</div>` : ''}\r\n      ${errorMessage ? html`<div class=\"file-error\">${errorMessage}</div>` : ''}\r\n    </div>\r\n  `;\r\n}\r\n"]}